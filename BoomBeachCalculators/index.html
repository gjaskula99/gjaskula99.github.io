<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Boom Beach Calculators</title>
  <style>
    body{font-family:Arial, sans-serif;padding:1rem;max-width:900px;margin:auto;}
    h1{text-align:center;}
    .grid{display:flex;flex-wrap:nowrap;gap:0.75rem;}
    .resource{flex:1 1 200px;border:1px solid #ccc;padding:0.75rem;border-radius:6px;}
    .icon{width:23px;height:20px;vertical-align:middle;margin-right:4px;}
    label{display:block;font-weight:600;margin-top:0.25rem;}
    input{width:100%;padding:0.4rem;margin-top:0.15rem;box-sizing:border-box;}
    button{display:block;margin:1rem auto;padding:0.6rem 1.2rem;font-size:1rem;border:none;border-radius:4px;cursor:pointer;}
    #output{margin-top:1.5rem;border-top:2px solid #333;padding-top:1.25rem;}
    /* --- tab bar --- */
    .tabs{display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;border-bottom:2px solid #333;}
    .tab{background:none;border:none;padding:0.5rem 0.75rem;font-weight:600;cursor:pointer;border-bottom:4px solid transparent;}
    .tab.active{border-color:#333;}
    .tab:hover{background:#f2f2f2;}
    .tab-content{display:none;}
    .tab-content.active{display:block;}
    @media(max-width:600px){
      .resource{flex:1 1 100%;}
      .grid{flex-wrap:wrap;}
    }
  </style>
</head>
<body>
  <h1>Boom Beach Calculators</h1>

  <!-- tab navigation -->
  <div class="tabs">
    <button class="tab active" data-target="ec">Evil Coins Resources</button>
    <button class="tab" data-target="cycle">Cycle of Evil Loot</button>
    <button class="tab" data-target="timers">Time Skip</button>
    <button class="tab" data-target="gunboat">Gunboat Energy</button>
    <button class="tab" data-target="future">Coming soon...</button>
  </div>

  <section id="ec" class="tab-content active">
    <div class="grid">
      <div class="resource">
        <label for="goldCur"><img class="icon" src="images/Gold.webp" alt="Gold">Gold&nbsp;Current</label><input type="number" id="goldCur" placeholder="e.g. 120000">
        <label for="goldReq"><img class="icon" src="images/Gold.webp" alt="Gold">Gold Required</label><input type="number" id="goldReq" placeholder="e.g. 500000">
      </div>
      <div class="resource">
        <label for="woodCur"><img class="icon" src="images/Wood.webp" alt="Wood">Wood&nbsp;Current</label><input type="number" id="woodCur">
        <label for="woodReq"><img class="icon" src="images/Wood.webp" alt="Wood">Wood Required</label><input type="number" id="woodReq">
      </div>
      <div class="resource">
        <label for="stoneCur"><img class="icon" src="images/Stone.webp" alt="Stone">Stone&nbsp;Current</label><input type="number" id="stoneCur">
        <label for="stoneReq"><img class="icon" src="images/Stone.webp" alt="Stone">Stone Required</label><input type="number" id="stoneReq">
      </div>
      <div class="resource">
        <label for="ironCur"><img class="icon" src="images/Iron.webp" alt="Iron">Iron&nbsp;Current</label><input type="number" id="ironCur">
        <label for="ironReq"><img class="icon" src="images/Iron.webp" alt="Iron">Iron Required</label><input type="number" id="ironReq">
      </div>
    </div>

    <button onclick="computeEC()">Compute Evil Coins</button>
    <div id="outputEC"></div>
  </section>

  <section id="cycle" class="tab-content">
    <div class="grid">
      <div class="resource">
        <label for="cycleType">Event</label>
        <select id="cycleType">
          <option value="hammerman">Hammerman¬†Strikes¬†Back</option>
          <option value="drt">Dr.¬†T</option>
          <option value="war_factory">War¬†Factory</option>
          <option value="imitation_game">Imitation¬†Game</option>
        </select>
      </div>
      <div class="resource">
        <label for="cycleThreat">Starting¬†Threat¬†(1‚Äë26)</label>
        <input type="number" id="cycleThreat" min="1" max="26" value="1">
      </div>
    </div>

    <button onclick="computeCycle()">Compute Loot</button>

    <div id="outputCycle"></div>
  </section>

  <section id="timers" class="tab-content">
    <div class="grid">
      <div class="resource" style="flex:1 1 250px;">
        <label for="timeHours"><img class="icon" src="images/Stopwatch.webp" alt="Time">Time¬†Remaining¬†(hours)</label>
        <input type="number" id="timeHours" placeholder="e.g.¬†20">
      </div>
    </div>
    <p>This is using old diamond formula.</p>
    <button onclick="computeDiamonds()">Compute¬†Diamonds</button>

    <div id="outputDiamonds"></div>
  </section>

  <section id="gunboat" class="tab-content">
    <div class="grid">
      <!-- Row 1: Artillery ‚Äì Shock -->
      <div class="resource">
        <img class="icon" src="images/Artillery_new.webp" alt="artillery">
        <label for="artilleryCount">Artillery uses</label>
        <input type="number" id="artilleryCount" min="0" value="0">
      </div>
      <div class="resource">
        <img class="icon" src="images/Flare.webp" alt="flare">
        <label for="flareCount">Flare uses</label>
        <input type="number" id="flareCount" min="0" value="0">
      </div>
      <div class="resource">
        <img class="icon" src="images/Medkit.webp" alt="medkit">
        <label for="medkitCount">Medkit uses</label>
        <input type="number" id="medkitCount" min="0" value="0">
      </div>
      <div class="resource">
        <img class="icon" src="images/Shock_Bomb.webp" alt="shock">
        <label for="shockCount">Shock Bomb uses</label>
        <input type="number" id="shockCount" min="0" value="0">
      </div>
    </div>

    <div class="grid">
      <!-- Row 2: Barrage ‚Äì Critters -->
      <div class="resource">
        <img class="icon" src="images/Barrage.webp" alt="barrage">
        <label for="barrageCount">Barrage uses</label>
        <input type="number" id="barrageCount" min="0" value="0">
      </div>
      <div class="resource">
        <img class="icon" src="images/Smoke_Screen.webp" alt="smoke">
        <label for="smokeCount">Smoke Screen uses</label>
        <input type="number" id="smokeCount" min="0" value="0">
      </div>
      <div class="resource">
        <img class="icon" src="images/Critters.webp" alt="critters">
        <label for="crittersCount">Critters uses</label>
        <input type="number" id="crittersCount" min="0" value="0">
      </div>
    </div>

    <div class="grid">
      <!-- Row 3: Gunboat level & bonus -->
      <div class="resource">
        <img class="icon" src="images/GB22.webp" alt="gunboat">
        <label for="gunboatLevel">Gunboat Level</label>
        <select id="gunboatLevel">
          <option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option>
          <option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option>
          <option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option>
          <option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option>
          <option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option>
          <option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option>
          <option value="25">25</option><option value="26">26</option><option value="27">27</option>
        </select>
      </div>
      <div class="resource">
        <img class="icon" src="images/Ammo.webp" alt="gbe">
        <label for="gbeBonus">GBE Bonus (%)</label>
        <input type="number" id="gbeBonus" min="0" value="0">
      </div>
    </div>

    <button onclick="computeGunboat()">Compute¬†GBE</button>

    <div id="outputGunboat"></div>
  </section>

  <section id="future" class="tab-content">
    <div class="grid">
      <p>Coming soon...</p>
    </div>

    <button onclick="dummy()">Dummy button</button>

    <div id="outputDummy"></div>
  </section>


    <script>
      /* Utility for ceiling integer division */
      const ceilDiv = (a,b) => Math.ceil(a/b);
      
      /* tab handling */
      document.querySelectorAll('.tab').forEach(btn=>{
        btn.addEventListener('click',()=>{
          // activate button
          document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          // show corresponding section
          const target = btn.dataset.target;
          document.querySelectorAll('.tab-content').forEach(sec=>sec.classList.remove('active'));
          document.getElementById(target).classList.add('active');
        });
      });

      /* Exchange rates and pack sizes for EC*/
      const rates = {
        gold:  {smallCost:60, smallSize:50000,  bigCost:1200,  bigSize:1000000},
        wood:  {smallCost:75, smallSize:50000,  bigCost:1500,  bigSize:1000000},
        stone: {smallCost:90, smallSize:50000,  bigCost:1800,  bigSize:1000000},
        iron:  {smallCost:125, smallSize:50000,  bigCost:2500, bigSize:1000000}
      };

      /** Evil Coins calculator */
      function computeEC(){
        const names = ['gold','wood','stone','iron'];
        let html = '';
        let totalEC = 0;

        names.forEach(name=>{
          const cur = Number(document.getElementById(name+'Cur').value) || 0;
          const req = Number(document.getElementById(name+'Req').value) || 0;
          const deficit = Math.max(0, req - cur);

          if(deficit === 0){
            html += `<p><strong>${name}</strong>: No purchase needed</p>`;
            return;
          }

          const r = rates[name];
          const rounded = ceilDiv(deficit, r.smallSize) * r.smallSize;         // round up to 50‚ÄØk increment
          const bigPacks = Math.floor(rounded / r.bigSize);
          const remainder = rounded % r.bigSize;
          const smallPacks = remainder / r.smallSize;
          const cost = bigPacks * r.bigCost + smallPacks * r.smallCost;

          totalEC += cost;

          html += `<p><strong>${name}</strong>: need ${rounded.toLocaleString()} (${deficit.toLocaleString()} deficit)<br>
                   ‚Üí ${bigPacks} √ó ${(r.bigSize/1000).toLocaleString()}k + ${smallPacks} √ó 50k packs = <em>${cost}‚ÄØ<img class=\"icon\" src=\"images/Evil_Coin.webp\" alt=\"EC\"></em></p>`;
        });

        html += `<h3>Total Evil Coins <img class=\"icon\" src=\"images/Evil_Coin.webp\" alt=\"EC\"> required: ${totalEC.toLocaleString()}</h3>`;
        document.getElementById('outputEC').innerHTML = html;
      }

      /* Cycle of Evil: sum total EC & Proto Tokens over 7 stages starting from threat */
      function computeCycle(){
        const type = document.getElementById('cycleType').value;
        let start = Number(document.getElementById('cycleThreat').value) || 1;
        if(start < 1) start = 1; if(start > 26) start = 26;

        const out = document.getElementById('outputCycle');

        // Data tables (index by threat level; index 0 unused)
        const drt = [null,
          {ec:20,pt:10},{ec:23,pt:11},{ec:27,pt:13},{ec:31,pt:15},{ec:35,pt:17},{ec:40,pt:19},
          {ec:45,pt:22},{ec:55,pt:25},{ec:65,pt:28},{ec:75,pt:32},{ec:85,pt:37},{ec:95,pt:42},
          {ec:110,pt:48},{ec:130,pt:54},{ec:150,pt:62},{ec:170,pt:71},{ec:200,pt:80},{ec:230,pt:92},
          {ec:265,pt:104},{ec:305,pt:119},{ec:350,pt:136},{ec:390,pt:154},{ec:425,pt:176},{ec:455,pt:200},
          {ec:480,pt:228},{ec:500,pt:260}
        ];

        const hammer = [null,
          {ec:25,pt:13},{ec:30,pt:14},{ec:35,pt:17},{ec:40,pt:20},{ec:45,pt:23},{ec:50,pt:26},
          {ec:60,pt:30},{ec:70,pt:34},{ec:80,pt:38},{ec:90,pt:43},{ec:105,pt:50},{ec:120,pt:57},
          {ec:140,pt:65},{ec:165,pt:73},{ec:190,pt:84},{ec:220,pt:96},{ec:250,pt:108},{ec:290,pt:124},
          {ec:335,pt:140},{ec:390,pt:160},{ec:450,pt:183},{ec:515,pt:207},{ec:565,pt:237},{ec:605,pt:269},
          {ec:635,pt:307},{ec:650,pt:350}
        ];

        // Imitation Game (adds BH/BD minima columns)
        const ig = [null,
          {ec:20,pt:10,bh:'0%', bd:'0%'}, {ec:23,pt:11,bh:'2%', bd:'1%'}, {ec:27,pt:13,bh:'4%', bd:'3%'},
          {ec:31,pt:15,bh:'6%', bd:'5%'}, {ec:35,pt:17,bh:'8%', bd:'7%'}, {ec:40,pt:19,bh:'10%', bd:'9%'},
          {ec:45,pt:22,bh:'12%', bd:'11%'}, {ec:55,pt:25,bh:'14%', bd:'13%'}, {ec:65,pt:28,bh:'16%', bd:'15%'},
          {ec:75,pt:32,bh:'18%', bd:'17%'}, {ec:85,pt:37,bh:'20%', bd:'19%'}, {ec:95,pt:42,bh:'22%', bd:'21%'},
          {ec:110,pt:48,bh:'24%', bd:'23%'}, {ec:130,pt:54,bh:'26%', bd:'25%'}, {ec:150,pt:62,bh:'28%', bd:'27%'},
          {ec:170,pt:71,bh:'30%', bd:'29%'}, {ec:200,pt:80,bh:'32%', bd:'31%'}, {ec:230,pt:92,bh:'34%', bd:'33%'},
          {ec:265,pt:104,bh:'36%', bd:'35%'}, {ec:305,pt:119,bh:'38%', bd:'37%'}, {ec:350,pt:136,bh:'40%', bd:'39%'},
          {ec:390,pt:154,bh:'42%', bd:'41%'}, {ec:425,pt:176,bh:'44%', bd:'43%'}, {ec:455,pt:200,bh:'46%', bd:'45%'},
          {ec:480,pt:228,bh:'48%', bd:'47%'}, {ec:500,pt:260,bh:'50%', bd:'49%'}
        ];

        if(type === 'war_factory'){
          out.innerHTML = '<p>Will be updated when sufficient data is available.</p>';
          return;
        }

        let table = hammer; let showIG = false;
        if(type === 'drt') table = drt; else if(type === 'hammerman') table = hammer; else if(type === 'imitation_game'){ table = ig; }

        let totalEC = 0, totalPT = 0;
        let rows = '';

        for(let i=0;i<7;i++){
          const lvl = Math.min(26, start + i);
          const row = table[lvl];
          totalEC += row.ec; totalPT += row.pt;
          if(showIG){
            rows += `<tr><td>${lvl}</td><td>${row.bh}</td><td>${row.bd}</td><td>${row.ec}</td><td>${row.pt}</td></tr>`;
          }else{
            rows += `<tr><td>${lvl}</td><td>${row.ec}</td><td>${row.pt}</td></tr>`;
          }
        }

        const head = showIG
          ? `<tr>
               <th style=\"text-align:left;border-bottom:1px solid #ccc;\">Threat</th>
               <th style=\"text-align:left;border-bottom:1px solid #ccc;\">Min BH</th>
               <th style=\"text-align:left;border-bottom:1px solid #ccc;\">Min BD</th>
               <th style=\"text-align:left;border-bottom:1px solid #ccc;\">Evil Coins <img class=\"icon\" src=\"images/Evil_Coin.webp\" alt=\"EC\"></th>
               <th style=\"text-align:left;border-bottom:1px solid #ccc;\">Proto Tokens <img class=\"icon\" src=\"images/ProtoTokenNew.webp\" alt=\"Proto Token\"></th>
             </tr>`
          : `<tr>
               <th style=\"text-align:left;border-bottom:1px solid #ccc;\">Threat</th>
               <th style=\"text-align:left;border-bottom:1px solid #ccc;\">Evil Coins <img class=\"icon\" src=\"images/Evil_Coin.webp\" alt=\"EC\"></th>
               <th style=\"text-align:left;border-bottom:1px solid #ccc;\">Proto Tokens <img class=\"icon\" src=\"images/ProtoTokenNew.webp\" alt=\"Proto Token\"></th>
             </tr>`;

        out.innerHTML = `
          <table style="width:100%;border-collapse:collapse;margin-top:0.5rem;">
            <thead>${head}</thead>
            <tbody>${rows}</tbody>
            <tfoot>
              <tr>
                <td style="border-top:2px solid #333;" ${showIG ? 'colspan="3"' : ''}><strong>Total</strong></td>
                <td style="border-top:2px solid #333;"><strong>${totalEC}</strong></td>
                <td style="border-top:2px solid #333;"><strong>${totalPT}</strong></td>
              </tr>
            </tfoot>
          </table>`;
      }

      /* Diamond time‚Äëto‚Äëcost calculator */
      function computeDiamonds(){
        const T = Number(document.getElementById('timeHours').value) || 0;
        const out = document.getElementById('outputDiamonds');
        if(T <= 0){
          out.innerHTML = '<p>Please enter a positive number of hours.</p>';
          return;
        }
        const D = 1.25 * 20.147 * Math.pow(T, 0.7513);
        const rate = D / T;

        const timeSavers = Math.ceil(T*4);

        out.innerHTML =
          `<p>Cost to finish now: <strong>${D.toFixed(2)}</strong> <img class="icon" src="images/Diamond.webp" alt="Diamonds"></p>
           <p>Cost efficiency: <strong>${rate.toFixed(2)}</strong> <img class="icon" src="images/Diamond.webp" alt="Diamonds"> per hour skipped</p>
           <p>Equivalent in Time Savers is <strong>${timeSavers.toFixed(0)}</strong> <img class="icon" src="images/TimeSaver.webp" alt="TimeSaver">`;
      }

      /* GBE Calculator */
      function computeGunboat(){
        const abilities = {
          artillery:{init:3, inc:2, id:'artilleryCount'},
          flare:{init:2, inc:1, id:'flareCount'},
          medkit:{init:6, inc:3, id:'medkitCount'},
          shock:{init:7, inc:5, id:'shockCount'},
          barrage:{init:10, inc:6, id:'barrageCount'},
          smoke:{init:2, inc:1, id:'smokeCount'},
          critters:{init:8, inc:5, id:'crittersCount'}
        };

        /* helper: arithmetic‚Äëseries sum */
        const seriesSum = (first, inc, n) => n * ( (2*first) + (n-1)*inc ) / 2;

        let totalUsed = 0;
        for(const key in abilities){
          const cnt = Number(document.getElementById(abilities[key].id).value) || 0;
          totalUsed += seriesSum(abilities[key].init, abilities[key].inc, cnt);
        }

        /* Gunboat base energy by level */
        const gbeByLevel = [0,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,51,52,53,54,55,56,57];
        const lvl = Number(document.getElementById('gunboatLevel').value);
        let available = gbeByLevel[lvl];

        /* bonus as percentage */
        const bonusPct = Number(document.getElementById('gbeBonus').value) || 0;
        available = available * (1 + bonusPct/100);

        const out = document.getElementById('outputGunboat');
        const suff = available >= totalUsed;

        out.innerHTML =
          `<p>Total <img class="icon" src="images/Ammo.webp" alt="gbe"> required: <strong>${totalUsed.toFixed(1)}</strong></p>
           <p><img class="icon" src="images/Ammo.webp" alt="gbe"> available (level¬†${lvl} + ${bonusPct}%): <strong>${available.toFixed(1)}</strong></p>
           <p><strong>${suff ? 'Sufficient üëç' : 'Insufficient ‚ö†Ô∏è'}</strong></p>`;
      }

      /* Dummy function */
      function dummy(){
        const out = document.getElementById('outputDummy');
        out.innerHTML =
          `<h2>Results</h2>
           Hello World`;
      }
    </script>
    <footer style="margin-top:2rem;text-align:center;font-size:0.85rem;color:#555;">
        Updated for 20&nbsp;Nov&nbsp;2025. Results may not be 100% accurate.
    </footer>
</body>
</html>